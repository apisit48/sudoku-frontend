import{av as Y,M as X,D as C,H as _,Q as g,I as E,J as R,K as L,m as A,F as D,aw as q,G as Z,R as ee,S as te}from"./index-bc405bf9.js";import{u as ne}from"./websocket-faccd31e.js";import{c as J,a as oe}from"./_commonjsHelpers-042e6b4d.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";import{V as ie}from"./VCardActions-2d1468b4.js";import"./useRender-926a478b.js";var P={exports:{}},U={};(function(r){(function(){var n,d,s,f,p={}.hasOwnProperty,u=[].slice;n={LF:`
`,NULL:"\0"},s=function(){var a;function i(t,e,o){this.command=t,this.headers=e??{},this.body=o??""}return i.prototype.toString=function(){var t,e,o,c,l;t=[this.command],o=this.headers["content-length"]===!1,o&&delete this.headers["content-length"],l=this.headers;for(e in l)p.call(l,e)&&(c=l[e],t.push(""+e+":"+c));return this.body&&!o&&t.push("content-length:"+i.sizeOfUTF8(this.body)),t.push(n.LF+this.body),t.join(n.LF)},i.sizeOfUTF8=function(t){return t?encodeURI(t).match(/%..|./g).length:0},a=function(t){var e,o,c,l,b,v,m,y,S,h,I,$,N,T,F,O,w;for(l=t.search(RegExp(""+n.LF+n.LF)),b=t.substring(0,l).split(n.LF),c=b.shift(),v={},$=function(k){return k.replace(/^\s+|\s+$/g,"")},O=b.reverse(),N=0,F=O.length;N<F;N++)h=O[N],y=h.indexOf(":"),v[$(h.substring(0,y))]=$(h.substring(y+1));if(e="",I=l+2,v["content-length"])S=parseInt(v["content-length"]),e=(""+t).substring(I,I+S);else for(o=null,m=T=I,w=t.length;(I<=w?T<w:T>w)&&(o=t.charAt(m),o!==n.NULL);m=I<=w?++T:--T)e+=o;return new i(c,v,e)},i.unmarshall=function(t){var e;return function(){var o,c,l,b;for(l=t.split(RegExp(""+n.NULL+n.LF+"*")),b=[],o=0,c=l.length;o<c;o++)e=l[o],(e!=null?e.length:void 0)>0&&b.push(a(e));return b}()},i.marshall=function(t,e,o){var c;return c=new i(t,e,o),c.toString()+n.NULL},i}(),d=function(){var a;function i(t){this.ws=t,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return i.prototype.debug=function(t){var e;return typeof window<"u"&&window!==null&&(e=window.console)!=null?e.log(t):void 0},a=function(){return Date.now?Date.now():new Date().valueOf},i.prototype._transmit=function(t,e,o){var c;for(c=s.marshall(t,e,o),typeof this.debug=="function"&&this.debug(">>> "+c);;)if(c.length>this.maxWebSocketFrameSize)this.ws.send(c.substring(0,this.maxWebSocketFrameSize)),c=c.substring(this.maxWebSocketFrameSize),typeof this.debug=="function"&&this.debug("remaining = "+c.length);else return this.ws.send(c)},i.prototype._setupHeartbeat=function(t){var e,o,c,l,b,v;if(!((b=t.version)!==f.VERSIONS.V1_1&&b!==f.VERSIONS.V1_2)&&(v=function(){var m,y,S,h;for(S=t["heart-beat"].split(","),h=[],m=0,y=S.length;m<y;m++)l=S[m],h.push(parseInt(l));return h}(),o=v[0],e=v[1],this.heartbeat.outgoing===0||e===0||(c=Math.max(this.heartbeat.outgoing,e),typeof this.debug=="function"&&this.debug("send PING every "+c+"ms"),this.pinger=f.setInterval(c,function(m){return function(){return m.ws.send(n.LF),typeof m.debug=="function"?m.debug(">>> PING"):void 0}}(this))),!(this.heartbeat.incoming===0||o===0)))return c=Math.max(this.heartbeat.incoming,o),typeof this.debug=="function"&&this.debug("check PONG every "+c+"ms"),this.ponger=f.setInterval(c,function(m){return function(){var y;if(y=a()-m.serverActivity,y>c*2)return typeof m.debug=="function"&&m.debug("did not receive server activity for the last "+y+"ms"),m.ws.close()}}(this))},i.prototype._parseConnect=function(){var t,e,o,c;switch(t=1<=arguments.length?u.call(arguments,0):[],c={},t.length){case 2:c=t[0],e=t[1];break;case 3:t[1]instanceof Function?(c=t[0],e=t[1],o=t[2]):(c.login=t[0],c.passcode=t[1],e=t[2]);break;case 4:c.login=t[0],c.passcode=t[1],e=t[2],o=t[3];break;default:c.login=t[0],c.passcode=t[1],e=t[2],o=t[3],c.host=t[4]}return[c,e,o]},i.prototype.connect=function(){var t,e,o,c;return t=1<=arguments.length?u.call(arguments,0):[],c=this._parseConnect.apply(this,t),o=c[0],this.connectCallback=c[1],e=c[2],typeof this.debug=="function"&&this.debug("Opening Web Socket..."),this.ws.onmessage=function(l){return function(b){var v,m,y,S,h,I,$,N,T,F,O,w;if(S=typeof ArrayBuffer<"u"&&b.data instanceof ArrayBuffer?(v=new Uint8Array(b.data),typeof l.debug=="function"&&l.debug("--- got data length: "+v.length),function(){var k,G,W;for(W=[],k=0,G=v.length;k<G;k++)m=v[k],W.push(String.fromCharCode(m));return W}().join("")):b.data,l.serverActivity=a(),S===n.LF){typeof l.debug=="function"&&l.debug("<<< PONG");return}for(typeof l.debug=="function"&&l.debug("<<< "+S),O=s.unmarshall(S),w=[],T=0,F=O.length;T<F;T++)switch(h=O[T],h.command){case"CONNECTED":typeof l.debug=="function"&&l.debug("connected to server "+h.headers.server),l.connected=!0,l._setupHeartbeat(h.headers),w.push(typeof l.connectCallback=="function"?l.connectCallback(h):void 0);break;case"MESSAGE":N=h.headers.subscription,$=l.subscriptions[N]||l.onreceive,$?(y=l,I=h.headers["message-id"],h.ack=function(k){return k==null&&(k={}),y.ack(I,N,k)},h.nack=function(k){return k==null&&(k={}),y.nack(I,N,k)},w.push($(h))):w.push(typeof l.debug=="function"?l.debug("Unhandled received MESSAGE: "+h):void 0);break;case"RECEIPT":w.push(typeof l.onreceipt=="function"?l.onreceipt(h):void 0);break;case"ERROR":w.push(typeof e=="function"?e(h):void 0);break;default:w.push(typeof l.debug=="function"?l.debug("Unhandled frame: "+h):void 0)}return w}}(this),this.ws.onclose=function(l){return function(){var b;return b="Whoops! Lost connection to "+l.ws.url,typeof l.debug=="function"&&l.debug(b),l._cleanUp(),typeof e=="function"?e(b):void 0}}(this),this.ws.onopen=function(l){return function(){return typeof l.debug=="function"&&l.debug("Web Socket Opened..."),o["accept-version"]=f.VERSIONS.supportedVersions(),o["heart-beat"]=[l.heartbeat.outgoing,l.heartbeat.incoming].join(","),l._transmit("CONNECT",o)}}(this)},i.prototype.disconnect=function(t,e){return e==null&&(e={}),this._transmit("DISCONNECT",e),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof t=="function"?t():void 0},i.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&f.clearInterval(this.pinger),this.ponger)return f.clearInterval(this.ponger)},i.prototype.send=function(t,e,o){return e==null&&(e={}),o==null&&(o=""),e.destination=t,this._transmit("SEND",e,o)},i.prototype.subscribe=function(t,e,o){var c;return o==null&&(o={}),o.id||(o.id="sub-"+this.counter++),o.destination=t,this.subscriptions[o.id]=e,this._transmit("SUBSCRIBE",o),c=this,{id:o.id,unsubscribe:function(){return c.unsubscribe(o.id)}}},i.prototype.unsubscribe=function(t){return delete this.subscriptions[t],this._transmit("UNSUBSCRIBE",{id:t})},i.prototype.begin=function(t){var e,o;return o=t||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:o}),e=this,{id:o,commit:function(){return e.commit(o)},abort:function(){return e.abort(o)}}},i.prototype.commit=function(t){return this._transmit("COMMIT",{transaction:t})},i.prototype.abort=function(t){return this._transmit("ABORT",{transaction:t})},i.prototype.ack=function(t,e,o){return o==null&&(o={}),o["message-id"]=t,o.subscription=e,this._transmit("ACK",o)},i.prototype.nack=function(t,e,o){return o==null&&(o={}),o["message-id"]=t,o.subscription=e,this._transmit("NACK",o)},i}(),f={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(a,i){var t,e;return i==null&&(i=["v10.stomp","v11.stomp"]),t=f.WebSocketClass||WebSocket,e=new t(a,i),new d(e)},over:function(a){return new d(a)},Frame:s},r!==null&&(r.Stomp=f),typeof window<"u"&&window!==null?(f.setInterval=function(a,i){return window.setInterval(i,a)},f.clearInterval=function(a){return window.clearInterval(a)},window.Stomp=f):r||(self.Stomp=f)}).call(J)})(U);var M={};const se={},ce=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),le=oe(ce);var B,z;function ae(){if(z)return B;z=1;var r=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return B=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}(),B}const ue="websocket",fe="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",de=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],pe="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",he=["IÃ±aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],ge="1.0.34",me={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},be="https://github.com/theturtle32/WebSocket-Node",ve={node:">=4.0.0"},ye={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},we={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},ke={verbose:!1},Se={test:"tape test/unit/*.js",gulp:"gulp"},Ce="index",_e={lib:"./lib"},Ie="lib/browser.js",Te="Apache-2.0",Ne={name:ue,description:fe,keywords:de,author:pe,contributors:he,version:ge,repository:me,homepage:be,engines:ve,dependencies:ye,devDependencies:we,config:ke,scripts:Se,main:Ce,directories:_e,browser:Ie,license:Te};var j,H;function $e(){return H||(H=1,j=Ne.version),j}var V,x;function Oe(){if(x)return V;x=1;var r;if(typeof globalThis=="object")r=globalThis;else try{r=ae()}catch{}finally{if(!r&&typeof window<"u"&&(r=window),!r)throw new Error("Could not determine global this")}var n=r.WebSocket||r.MozWebSocket,d=$e();function s(f,p){var u;return p?u=new n(f,p):u=new n(f),u}return n&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(f){Object.defineProperty(s,f,{get:function(){return n[f]}})}),V={w3cwebsocket:n?s:null,version:d},V}(function(){var r,n,d,s,f,p;r=U,n=le,r.Stomp.setInterval=function(u,a){return setInterval(a,u)},r.Stomp.clearInterval=function(u){return clearInterval(u)},f=function(u,a){var i,t;return i=null,t={url:"tcp:// "+a+":"+u,send:function(e){return i.write(e)},close:function(){return i.end()}},i=n.connect(u,a,function(e){return t.onopen()}),i.on("error",function(e){return typeof t.onclose=="function"?t.onclose(e):void 0}),i.on("close",function(e){return typeof t.onclose=="function"?t.onclose(e):void 0}),i.on("data",function(e){var o;return o={data:e.toString()},t.onmessage(o)}),t},p=function(u){var a,i,t,e;return a=Oe().client,i=null,e={url:u,send:function(o){return i.sendUTF(o)},close:function(){return i.close()}},t=new a,t.on("connect",function(o){return i=o,e.onopen(),i.on("error",function(c){return typeof e.onclose=="function"?e.onclose(c):void 0}),i.on("close",function(){return typeof e.onclose=="function"?e.onclose():void 0}),i.on("message",function(c){var l;if(c.type==="utf8")return l={data:c.utf8Data},e.onmessage(l)})}),t.connect(u),e},d=function(u,a){var i;return i=f(a,u),r.Stomp.over(i)},s=function(u){var a;return a=p(u),r.Stomp.over(a)},M.overTCP=d,M.overWS=s}).call(J);var Ee=U,K=M;P.exports=Ee.Stomp;P.exports.overTCP=K.overTCP;P.exports.overWS=K.overWS;const Le={name:"Grid",computed:Y(["grid"]),methods:{timer(){this.$store.state.timer+=1,this.$store.state.gameCompleted||setTimeout(this.timer,1e3)},pickNumber(r){if(this.$store.state.gameCompleted)return;let n=parseInt(String.fromCharCode(r.keyCode),10);if(!n)return;this.$store.commit("setNumber",n);const d=this.grid.find(s=>s.some(f=>f.selected));if(d){const s=this.grid.indexOf(d),f=d.findIndex(p=>p.selected);this.checkCompletions([s,f])}},setSelected(r,n,d){this.$store.state.gameCompleted||this.$store.commit("setSelected",{x:n,y:d})},gameWon(){document.getElementById("winContainer").style.display="flex",this.$store.state.gameCompleted=!0},checkFullCompletion(){const r=this.$store.state.grid;for(let n=0;n<r.length;n++)for(let d=0;d<r[n].length;d++)if(!r[n][d].completed&&!r[n][d].given){console.log(n+" "+d);return}this.gameWon()},checkCompletions(r){const n=[this.checkSubSquareCompletion,this.checkVerticalCompletion,this.checkHorizontalCompletion];let d=null;for(let s=0;s<n.length;s++)d=n[s](r),!(d<0)&&(this.$store.state.playerScores.player+=100);this.checkFullCompletion()},checkSubSquareCompletion(r){const n=r[0],d=r[1],s=Math.floor(n/3)*3,f=Math.floor(d/3)*3;let p=0;for(let u=s;u<s+3;u++)for(let a=f;a<f+3;a++)this.grid[u]&&this.grid[u][a]&&this.grid[u][a].value===this.grid[u][a].solution&&p++;if(p!==9)return-1;this.$store.state.completedSquares+=1;for(let u=s;u<s+3;u++)for(let a=f;a<f+3;a++)this.$store.state.grid[u][a].completed=!0,this.$store.state.grid[u][a].locked=!0,this.$store.state.grid[u][a].selected=!1;return JSON.stringify({messageType:"COMPLETION",roomId:this.$store.state.roomId,completionType:"square",completionRow:r[0],completionCol:r[1]})},checkVerticalCompletion(r){const n=r[1];let d=0;for(let s=0;s<9;s++)this.grid[s]&&this.grid[s][n]&&this.grid[s][n].value===this.grid[s][n].solution&&d++;if(d!==9)return-1;for(let s=0;s<9;s++)this.grid[s]&&this.grid[s][n]&&(this.$store.state.grid[s][n].completed=this.grid[s][n].value===this.grid[s][n].solution,this.$store.state.grid[s][n].locked=!0,this.$store.state.grid[s][n].selected=!1);return JSON.stringify({messageType:"COMPLETION",roomId:this.$store.state.roomId,completionType:"vertical-line",completionRow:r[0],completionCol:r[1]})},checkHorizontalCompletion(r){const n=r[0];let d=0;for(let s=0;s<9;s++)this.grid[n]&&this.grid[n][s]&&this.grid[n][s].value===this.grid[n][s].solution&&d++;if(d!==9)return-1;for(let s=0;s<9;s++)this.grid[n]&&this.grid[n][s]&&(this.$store.state.grid[n][s].completed=this.grid[n][s].value===this.grid[n][s].solution,this.$store.state.grid[n][s].locked=!0,this.$store.state.grid[n][s].selected=!1);return JSON.stringify({messageType:"COMPLETION",roomId:this.$store.state.roomId,completionType:"horizontal-line",completionRow:r[0],completionCol:r[1]})},mutliplayerCheckCompletion(r,n,d){const s=Math.floor(n/3)*3,f=Math.floor(d/3)*3;switch(r){case"square":for(let p=s;p<s+3;p++)for(let u=f;u<f+3;u++)this.$store.state.grid[p][u].multiplayerCompleted=!0;break;case"vertical-line":for(let p=0;p<9;p++)this.grid[p]&&this.grid[p][d]&&(this.$store.state.grid[p][d].multiplayerCompleted=!0);break;case"horizontal-line":for(let p=0;p<9;p++)this.grid[n]&&this.grid[n][p]&&(this.$store.state.grid[n][p].multiplayerCompleted=!0);break}},connectToBackend:function(){const r=ne();this.$store.state.stompClient=r},onError:function(r){console.log(r)},onMessageReceived:function(r){if(r.body){let n=JSON.parse(r.body);switch(console.log(n.messageType),n.messageType){case"BOARD":console.log("Board string: "+n.boardString);break;case"COMPLETION":console.log("Type, index: ",n.completionType,n.completionRow,n.completionCol);break}}},onBoardMessageReceived:function(r){console.log(r)}},mounted(){this.$store.commit("initGrid"),window.addEventListener("keypress",this.pickNumber),this.connectToBackend(),setTimeout(this.timer,1e3)},unmounted(){window.removeEventListener("keypress",this.pickNumber),this.$store.state.timer=0,this.$store.state.gameCompleted=!1,this.$store.state.playerScores.player=0}},Q=r=>(ee("data-v-2e500af7"),r=r(),te(),r),Fe={class:"sections"},Re={class:"leftSection"},We={class:"sideSudoku"},Be={class:"middleSection"},je={class:"timerContainer"},Ve={class:"timer"},Me={class:"timerTxt"},Pe={class:"sudoku"},Ue=["onClick"],Ge={class:"rightSection"},Ae={class:"rankingsContainer"},De=Q(()=>g("div",{class:"scoresTxt"}," Scores ",-1)),qe={class:"rankingsBoard"},ze={class:"rankNumber"},He={class:"rankName"},xe={class:"rankScore"},Je={id:"winContainer",class:"winContainer playing"},Ke=Q(()=>g("div",{class:"winTxt"}," You Win! ",-1)),Qe={class:"winScoreTxt"};function Ye(r,n,d,s,f,p){const u=X("router-link");return C(),_(E,null,[g("div",Fe,[g("div",Re,[g("table",We,[g("tbody",null,[(C(!0),_(E,null,R(r.grid,(a,i)=>(C(),_("tr",{class:"sideTr",key:i},[(C(!0),_(E,null,R(a,(t,e)=>(C(),_("td",{class:q(["sideTd",{locked:r.grid[i][e].locked,selected:r.grid[i][e].selected,completed:r.grid[i][e].completed,given:r.grid[i][e].given,multiplayerCompleted:r.grid[i][e].multiplayerCompleted}]),key:e},null,2))),128))]))),128))])])]),g("div",Be,[g("div",je,[g("div",Ve,[g("div",Me,L(this.$store.state.timer),1)])]),g("table",Pe,[g("tbody",null,[(C(!0),_(E,null,R(r.grid,(a,i)=>(C(),_("tr",{key:i},[(C(!0),_(E,null,R(a,(t,e)=>(C(),_("td",{class:q(["sudokuCell",{locked:r.grid[i][e].locked,selected:r.grid[i][e].selected}]),key:e,onClick:o=>p.setSelected(r.grid[i][e],i,e)},L(r.grid[i][e].value),11,Ue))),128))]))),128))])])]),g("div",Ge,[g("div",Ae,[De,g("table",null,[g("tbody",qe,[(C(!0),_(E,null,R(this.$store.state.playerScores,(a,i,t)=>(C(),_("tr",{class:"rankingItem",key:i},[g("span",ze,L(t+1+". "),1),g("span",He,L(i+" "),1),g("span",xe,L(this.$store.state.timer),1)]))),128))])])])])]),g("div",Je,[Ke,g("div",Qe," Final score: "+L(this.$store.state.timer),1),A(ie,{class:"justify-center"},{default:D(()=>[g("button",{class:"custom-button",onClick:n[0]||(n[0]=(...a)=>r.redirectToHome&&r.redirectToHome(...a))},[A(u,{to:"/"},{default:D(()=>[Z("Back To Home")]),_:1})])]),_:1})])],64)}const rt=re(Le,[["render",Ye],["__scopeId","data-v-2e500af7"]]);export{rt as default};
